<?xml version="1.0" encoding= "UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="project.regist">
	<insert id="saveProject" parameterType="com.nbreds.projectPlanning.Project.VO.Project">
    <![CDATA[
		 insert into Project (
		  pname
		  ,pdetail
		  ,pdata
		  ,pregdate
		  ,pduedate
		  ,uno
		) VALUES (
		  #{pname}
		  ,#{pdetail}
		  ,#{pdata}
		  ,NOW()
		  ,#{pduedate}
		  ,#{uno}
		)
    ]]>  
    </insert>
    
    <insert id="saveProjectMS" parameterType="com.nbreds.projectPlanning.Project.VO.ProjectMemberStat">
    <![CDATA[
		 insert into ProjectMemberStat (
		  uno
		  ,pno
		  ,stat
		) VALUES (
		  #{uno}
		  ,#{pno}
		  ,#{stat}
		)
    ]]>  
    </insert>
    
   	<select id="getLastno" resultType="int">
	<![CDATA[	
		SELECT MAX(pno) FROM Project
	]]>  
	</select>    
	
	<select id="getCodeTable" parameterType="String" resultType="com.nbreds.projectPlanning.common.VO.CodeTable">
    <![CDATA[
     select CODE_TYPE, CODE, CODE_NAME from CodeTable where CODE_TYPE=#{CODE_TYPE}
    ]]>  
    </select>
    
    <select id="getUsersForName" parameterType="String" resultType="com.nbreds.projectPlanning.common.VO.User">
    <![CDATA[
    select uno, uname, uphoneno, udepartment, uemail
    from User
    where uname like '%' #{uname} '%'
    ]]>  
    </select>
    
    <select id="getUserForNo" parameterType="int" resultType="hashmap">
    <![CDATA[
    SELECT uno, uname, uphoneno, CODE_NAME, uemail
    FROM User, CodeTable
    WHERE uno=#{uno} AND CODE_TYPE='002' AND CODE=udepartment
    ]]>  
    </select>
    
    <select id="getAllUser" resultType="com.nbreds.projectPlanning.common.VO.User">
    <![CDATA[
    SELECT uno, uname, uphoneno, udepartment, uemail
    FROM User
    ]]>  
    </select>
    
</mapper>